#pragma checksum "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "d7decd4211c8dbb8761c32d297b0769fd8bdadc8"
// <auto-generated/>
#pragma warning disable 1591
namespace ALISS.Pages.P4_UserManagement.MasterManagement
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Components;
#nullable restore
#line 1 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\_Imports.razor"
using System.Net.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\_Imports.razor"
using System.Text.Json;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\_Imports.razor"
using Microsoft.AspNetCore.Components.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\_Imports.razor"
using Microsoft.AspNetCore.Components.Forms;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\_Imports.razor"
using Microsoft.JSInterop;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\_Imports.razor"
using System.Security.Claims;

#line default
#line hidden
#nullable disable
#nullable restore
#line 10 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\_Imports.razor"
using Microsoft.AspNetCore.HttpOverrides;

#line default
#line hidden
#nullable disable
#nullable restore
#line 12 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\_Imports.razor"
using Blazored;

#line default
#line hidden
#nullable disable
#nullable restore
#line 13 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\_Imports.razor"
using Blazored.Menu;

#line default
#line hidden
#nullable disable
#nullable restore
#line 15 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\_Imports.razor"
using Radzen;

#line default
#line hidden
#nullable disable
#nullable restore
#line 16 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\_Imports.razor"
using Radzen.Blazor;

#line default
#line hidden
#nullable disable
#nullable restore
#line 18 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\_Imports.razor"
using BlazorDownloadFile;

#line default
#line hidden
#nullable disable
#nullable restore
#line 20 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\_Imports.razor"
using ALISS;

#line default
#line hidden
#nullable disable
#nullable restore
#line 21 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\_Imports.razor"
using ALISS.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 22 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\_Imports.razor"
using ALISS.Data.Account;

#line default
#line hidden
#nullable disable
#nullable restore
#line 23 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\_Imports.razor"
using ALISS.Data.Client;

#line default
#line hidden
#nullable disable
#nullable restore
#line 25 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\_Imports.razor"
using ALISS.Data;

#line default
#line hidden
#nullable disable
#nullable restore
#line 27 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\_Imports.razor"
using ALISS.DropDownList.DTO;

#line default
#line hidden
#nullable disable
#nullable restore
#line 28 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\_Imports.razor"
using ALISS.LoginManagement.DTO;

#line default
#line hidden
#nullable disable
#nullable restore
#line 29 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\_Imports.razor"
using ALISS.Master.DTO;

#line default
#line hidden
#nullable disable
#nullable restore
#line 30 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\_Imports.razor"
using ALISS.Process.DTO;

#line default
#line hidden
#nullable disable
#nullable restore
#line 31 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\_Imports.razor"
using ALISS.AUTH.DTO;

#line default
#line hidden
#nullable disable
#nullable restore
#line 32 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\_Imports.razor"
using ALISS.MasterManagement.DTO;

#line default
#line hidden
#nullable disable
#nullable restore
#line 33 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\_Imports.razor"
using ALISS.UserManagement.DTO;

#line default
#line hidden
#nullable disable
#nullable restore
#line 34 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\_Imports.razor"
using ALISS.HISUpload.DTO;

#line default
#line hidden
#nullable disable
#nullable restore
#line 35 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\_Imports.razor"
using ALISS.ANTIBIOGRAM.DTO;

#line default
#line hidden
#nullable disable
#nullable restore
#line 36 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\_Imports.razor"
using ALISS.ANTIBIOTREND.DTO;

#line default
#line hidden
#nullable disable
#nullable restore
#line 37 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\_Imports.razor"
using ALISS.GLASS.DTO;

#line default
#line hidden
#nullable disable
#nullable restore
#line 39 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\_Imports.razor"
using ALISS.Data.D0_Master;

#line default
#line hidden
#nullable disable
#nullable restore
#line 41 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\_Imports.razor"
using ALISS.Data.D3_Process;

#line default
#line hidden
#nullable disable
#nullable restore
#line 42 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\_Imports.razor"
using ALISS.Data.D4_UserManagement.AUTH;

#line default
#line hidden
#nullable disable
#nullable restore
#line 43 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\_Imports.razor"
using ALISS.Data.D4_UserManagement.MasterManagement;

#line default
#line hidden
#nullable disable
#nullable restore
#line 44 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\_Imports.razor"
using ALISS.Data.D4_UserManagement.UserManagement;

#line default
#line hidden
#nullable disable
#nullable restore
#line 46 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\_Imports.razor"
using ALISS.Data.D5_HISData;

#line default
#line hidden
#nullable disable
#nullable restore
#line 47 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\_Imports.razor"
using ALISS.Data.D6_Report.Antibiogram;

#line default
#line hidden
#nullable disable
#nullable restore
#line 48 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\_Imports.razor"
using ALISS.Data.D6_Report.Antibiotrend;

#line default
#line hidden
#nullable disable
#nullable restore
#line 49 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\_Imports.razor"
using ALISS.Data.D6_Report.Glass;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
using System.IO;

#line default
#line hidden
#nullable disable
    [Microsoft.AspNetCore.Components.RouteAttribute("/MasterManagement/MasterTemplate/UploadDetail")]
    [Microsoft.AspNetCore.Components.RouteAttribute("/MasterManagement/MasterTemplate/UploadDetail/{mst_code}")]
    public partial class MasterTemplateUpload : Microsoft.AspNetCore.Components.ComponentBase
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
            __builder.OpenElement(0, "div");
            __builder.OpenElement(1, "div");
            __builder.AddAttribute(2, "class", "divHead");
            __builder.AddMarkupContent(3, "\r\n        Master Template - ");
            __builder.AddContent(4, 
#nullable restore
#line 24 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                           masterTemplateData.mst_version

#line default
#line hidden
#nullable disable
            );
            __builder.AddContent(5, " (");
            __builder.AddContent(6, 
#nullable restore
#line 24 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                            masterTemplateData.mst_code

#line default
#line hidden
#nullable disable
            );
            __builder.AddMarkupContent(7, ")\r\n    ");
            __builder.CloseElement();
            __builder.CloseElement();
#nullable restore
#line 28 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
 if (pageLoading)
{

#line default
#line hidden
#nullable disable
            __builder.AddMarkupContent(8, "<p><em>Loading...</em></p>");
            __builder.OpenComponent<ALISS.Shared.Loading>(9);
            __builder.AddAttribute(10, "ShowModel", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Boolean>(
#nullable restore
#line 32 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                        true

#line default
#line hidden
#nullable disable
            ));
            __builder.CloseComponent();
#nullable restore
#line 33 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
}
else
{

#line default
#line hidden
#nullable disable
            __builder.OpenComponent<Microsoft.AspNetCore.Components.Forms.EditForm>(11);
            __builder.AddAttribute(12, "Model", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Object>(
#nullable restore
#line 36 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                     masterTemplateData

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(13, "OnInvalidSubmit", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<Microsoft.AspNetCore.Components.EventCallback<Microsoft.AspNetCore.Components.Forms.EditContext>>(Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Forms.EditContext>(this, 
#nullable restore
#line 36 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                          HandleInvalidSubmit

#line default
#line hidden
#nullable disable
            )));
            __builder.AddAttribute(14, "OnValidSubmit", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<Microsoft.AspNetCore.Components.EventCallback<Microsoft.AspNetCore.Components.Forms.EditContext>>(Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Forms.EditContext>(this, 
#nullable restore
#line 36 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                                                              HandleValidSubmit

#line default
#line hidden
#nullable disable
            )));
            __builder.AddAttribute(15, "ChildContent", (Microsoft.AspNetCore.Components.RenderFragment<Microsoft.AspNetCore.Components.Forms.EditContext>)((context) => (__builder2) => {
                __builder2.OpenComponent<Microsoft.AspNetCore.Components.Forms.DataAnnotationsValidator>(16);
                __builder2.CloseComponent();
                __builder2.AddMarkupContent(17, "\r\n\r\n        ");
                __builder2.OpenElement(18, "div");
                __builder2.AddAttribute(19, "class", "container inputArea");
                __builder2.AddMarkupContent(20, "<br>\r\n            ");
                __builder2.OpenElement(21, "div");
                __builder2.AddAttribute(22, "class", "row");
                __builder2.OpenComponent<ALISS.Shared.InputBox>(23);
                __builder2.AddAttribute(24, "ConfigData", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<ALISS.Master.DTO.TBConfigDTO>(
#nullable restore
#line 42 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                        configData.Get_ConfigRow("mst_code")

#line default
#line hidden
#nullable disable
                ));
                __builder2.AddAttribute(25, "ChildContent", (Microsoft.AspNetCore.Components.RenderFragment)((__builder3) => {
                    __builder3.OpenComponent<Radzen.Blazor.RadzenTextBox>(26);
                    __builder3.AddAttribute(27, "Disabled", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Boolean>(
#nullable restore
#line 43 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                                                        true

#line default
#line hidden
#nullable disable
                    ));
                    __builder3.AddAttribute(28, "Value", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.String>(
#nullable restore
#line 43 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                 masterTemplateData.mst_code

#line default
#line hidden
#nullable disable
                    ));
                    __builder3.AddAttribute(29, "ValueChanged", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<Microsoft.AspNetCore.Components.EventCallback<System.String>>(Microsoft.AspNetCore.Components.EventCallback.Factory.Create<System.String>(this, Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.CreateInferredEventCallback(this, __value => masterTemplateData.mst_code = __value, masterTemplateData.mst_code))));
                    __builder3.AddAttribute(30, "ValueExpression", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Linq.Expressions.Expression<System.Func<System.String>>>(() => masterTemplateData.mst_code));
                    __builder3.CloseComponent();
                }
                ));
                __builder2.CloseComponent();
                __builder2.AddMarkupContent(31, "\r\n                ");
                __builder2.OpenComponent<ALISS.Shared.InputBox>(32);
                __builder2.AddAttribute(33, "ConfigData", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<ALISS.Master.DTO.TBConfigDTO>(
#nullable restore
#line 45 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                        configData.Get_ConfigRow("mst_date_from")

#line default
#line hidden
#nullable disable
                ));
                __builder2.AddAttribute(34, "ChildContent", (Microsoft.AspNetCore.Components.RenderFragment)((__builder3) => {
                    __Blazor.ALISS.Pages.P4_UserManagement.MasterManagement.MasterTemplateUpload.TypeInference.CreateRadzenDatePicker_0(__builder3, 35, 36, "dd/MM/yyyy", 37, 
#nullable restore
#line 46 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                                                                                        true

#line default
#line hidden
#nullable disable
                    , 38, "width:100%;", 39, 
#nullable restore
#line 46 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                    masterTemplateData.mst_date_from

#line default
#line hidden
#nullable disable
                    , 40, Microsoft.AspNetCore.Components.EventCallback.Factory.Create(this, Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.CreateInferredEventCallback(this, __value => masterTemplateData.mst_date_from = __value, masterTemplateData.mst_date_from)), 41, () => masterTemplateData.mst_date_from);
                    __builder3.AddMarkupContent(42, "\r\n                    ");
                    __Blazor.ALISS.Pages.P4_UserManagement.MasterManagement.MasterTemplateUpload.TypeInference.CreateValidationMessage_1(__builder3, 43, 44, 
#nullable restore
#line 47 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                              () => masterTemplateData.mst_date_from

#line default
#line hidden
#nullable disable
                    );
                }
                ));
                __builder2.CloseComponent();
                __builder2.CloseElement();
                __builder2.CloseElement();
            }
            ));
            __builder.CloseComponent();
            __builder.AddMarkupContent(45, "<hr>");
            __builder.OpenElement(46, "div");
            __builder.OpenElement(47, "div");
            __builder.AddAttribute(48, "class", "container");
            __builder.OpenElement(49, "div");
            __builder.AddAttribute(50, "class", "row justify-content-between buttonArea");
            __builder.OpenElement(51, "div");
            __builder.AddAttribute(52, "class", "col-auto");
            __builder.OpenComponent<Radzen.Blazor.RadzenButton>(53);
            __builder.AddAttribute(54, "class", "btnCancel");
            __builder.AddAttribute(55, "Text", "Cancel");
            __builder.AddAttribute(56, "Click", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<Microsoft.AspNetCore.Components.EventCallback<Microsoft.AspNetCore.Components.Web.MouseEventArgs>>(Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 60 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                                         RedirectToInbox

#line default
#line hidden
#nullable disable
            )));
            __builder.CloseComponent();
            __builder.CloseElement();
            __builder.AddMarkupContent(57, "\r\n\r\n                ");
            __builder.OpenElement(58, "div");
            __builder.AddAttribute(59, "class", "colcol-auto");
            __builder.OpenComponent<Radzen.Blazor.RadzenButton>(60);
            __builder.AddAttribute(61, "Icon", "file_upload");
            __builder.AddAttribute(62, "class", "btnAdd");
            __builder.AddAttribute(63, "Text", "Upload Excel Template (.xlsm)");
            __builder.AddAttribute(64, "Click", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<Microsoft.AspNetCore.Components.EventCallback<Microsoft.AspNetCore.Components.Web.MouseEventArgs>>(Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 64 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                                                                                  () => ShowPopupDialogUpload()

#line default
#line hidden
#nullable disable
            )));
            __builder.CloseComponent();
            __builder.CloseElement();
            __builder.CloseElement();
            __builder.CloseElement();
            __builder.AddMarkupContent(65, "\r\n        <br>\r\n        ");
            __builder.OpenElement(66, "div");
            __builder.AddAttribute(67, "style", "width:90%;margin:0px auto;");
            __builder.OpenComponent<Radzen.Blazor.RadzenTabs>(68);
            __builder.AddAttribute(69, "Tabs", (Microsoft.AspNetCore.Components.RenderFragment)((__builder2) => {
                __builder2.OpenComponent<Radzen.Blazor.RadzenTabsItem>(70);
                __builder2.AddAttribute(71, "Text", "Template Column");
                __builder2.AddAttribute(72, "Selected", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Boolean>(
#nullable restore
#line 83 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                                       _CurrentTab == "TEMPLATECOLUMNS" ? true : false

#line default
#line hidden
#nullable disable
                ));
                __builder2.AddAttribute(73, "ChildContent", (Microsoft.AspNetCore.Components.RenderFragment)((__builder3) => {
                    __builder3.OpenElement(74, "div");
                    __builder3.AddAttribute(75, "class", "row");
                    __builder3.OpenComponent<Radzen.Blazor.RadzenGrid<TCProcessExcelColumnDTO>>(76);
                    __builder3.AddAttribute(77, "AllowFiltering", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Boolean>(
#nullable restore
#line 85 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                        true

#line default
#line hidden
#nullable disable
                    ));
                    __builder3.AddAttribute(78, "AllowSorting", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Boolean>(
#nullable restore
#line 85 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                                            true

#line default
#line hidden
#nullable disable
                    ));
                    __builder3.AddAttribute(79, "AllowPaging", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Boolean>(
#nullable restore
#line 85 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                                                               true

#line default
#line hidden
#nullable disable
                    ));
                    __builder3.AddAttribute(80, "PageSize", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Int32>(
#nullable restore
#line 86 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                  excelColumnGrid.PageSize

#line default
#line hidden
#nullable disable
                    ));
                    __builder3.AddAttribute(81, "Data", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Collections.Generic.IEnumerable<TCProcessExcelColumnDTO>>(
#nullable restore
#line 86 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                                                                                     processExcelColumnDatas.OrderBy(o=>o.pec_sheet_name)

#line default
#line hidden
#nullable disable
                    ));
                    __builder3.AddAttribute(82, "ColumnWidth", "120px");
                    __builder3.AddAttribute(83, "FilterCaseSensitivity", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<Radzen.FilterCaseSensitivity>(
#nullable restore
#line 86 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                                                                                                                                                                                                                      FilterCaseSensitivity.CaseInsensitive

#line default
#line hidden
#nullable disable
                    ));
                    __builder3.AddAttribute(84, "AllowColumnResize", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Boolean>(
#nullable restore
#line 86 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                                                                                                                                                                                                                                                                                true

#line default
#line hidden
#nullable disable
                    ));
                    __builder3.AddAttribute(85, "Columns", (Microsoft.AspNetCore.Components.RenderFragment)((__builder4) => {
                        __builder4.OpenComponent<Radzen.Blazor.RadzenGridColumn<TCProcessExcelColumnDTO>>(86);
                        __builder4.AddAttribute(87, "Property", "pec_sheet_name");
                        __builder4.AddAttribute(88, "Title", "Sheet Name");
                        __builder4.CloseComponent();
                        __builder4.AddMarkupContent(89, "\r\n                                    ");
                        __builder4.OpenComponent<Radzen.Blazor.RadzenGridColumn<TCProcessExcelColumnDTO>>(90);
                        __builder4.AddAttribute(91, "Property", "pec_col_num");
                        __builder4.AddAttribute(92, "Title", "Column No.");
                        __builder4.CloseComponent();
                        __builder4.AddMarkupContent(93, "\r\n                                    ");
                        __builder4.OpenComponent<Radzen.Blazor.RadzenGridColumn<TCProcessExcelColumnDTO>>(94);
                        __builder4.AddAttribute(95, "Property", "pec_ant_code");
                        __builder4.AddAttribute(96, "Title", "Antibiotic Code");
                        __builder4.CloseComponent();
                        __builder4.AddMarkupContent(97, "\r\n                                    ");
                        __builder4.OpenComponent<Radzen.Blazor.RadzenGridColumn<TCProcessExcelColumnDTO>>(98);
                        __builder4.AddAttribute(99, "Property", "pec_col_name");
                        __builder4.AddAttribute(100, "Title", "Antibiotic Name");
                        __builder4.CloseComponent();
                        __builder4.AddMarkupContent(101, "\r\n                                    ");
                        __builder4.OpenComponent<Radzen.Blazor.RadzenGridColumn<TCProcessExcelColumnDTO>>(102);
                        __builder4.AddAttribute(103, "Property", "pec_col_group_num");
                        __builder4.AddAttribute(104, "Title", "Column Group No.");
                        __builder4.CloseComponent();
                        __builder4.AddMarkupContent(105, "\r\n                                    ");
                        __builder4.OpenComponent<Radzen.Blazor.RadzenGridColumn<TCProcessExcelColumnDTO>>(106);
                        __builder4.AddAttribute(107, "Property", "pec_col_group_name");
                        __builder4.AddAttribute(108, "Title", "Column Group Name");
                        __builder4.CloseComponent();
                        __builder4.AddMarkupContent(109, "\r\n                                    ");
                        __builder4.OpenComponent<Radzen.Blazor.RadzenGridColumn<TCProcessExcelColumnDTO>>(110);
                        __builder4.AddAttribute(111, "Property", "pec_MIC");
                        __builder4.AddAttribute(112, "Title", "MIC");
                        __builder4.CloseComponent();
                        __builder4.AddMarkupContent(113, "\r\n                                    ");
                        __builder4.OpenComponent<Radzen.Blazor.RadzenGridColumn<TCProcessExcelColumnDTO>>(114);
                        __builder4.AddAttribute(115, "Property", "pec_Urine");
                        __builder4.AddAttribute(116, "Title", "Urine");
                        __builder4.CloseComponent();
                    }
                    ));
                    __builder3.AddComponentReferenceCapture(117, (__value) => {
#nullable restore
#line 86 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                                                  excelColumnGrid.radzenGrid = (Radzen.Blazor.RadzenGrid<TCProcessExcelColumnDTO>)__value;

#line default
#line hidden
#nullable disable
                    }
                    );
                    __builder3.CloseComponent();
                    __builder3.AddMarkupContent(118, "\r\n                            <br>");
                    __builder3.CloseElement();
                }
                ));
                __builder2.CloseComponent();
                __builder2.AddMarkupContent(119, "\r\n                    ");
                __builder2.OpenComponent<Radzen.Blazor.RadzenTabsItem>(120);
                __builder2.AddAttribute(121, "Text", "Tamplate Row");
                __builder2.AddAttribute(122, "Selected", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Boolean>(
#nullable restore
#line 102 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                                    _CurrentTab == "TEMPLATEROWS" ? true : false

#line default
#line hidden
#nullable disable
                ));
                __builder2.AddAttribute(123, "ChildContent", (Microsoft.AspNetCore.Components.RenderFragment)((__builder3) => {
                    __builder3.OpenElement(124, "div");
                    __builder3.AddAttribute(125, "class", "row");
                    __builder3.OpenComponent<Radzen.Blazor.RadzenGrid<TCProcessExcelRowDTO>>(126);
                    __builder3.AddAttribute(127, "AllowFiltering", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Boolean>(
#nullable restore
#line 104 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                        true

#line default
#line hidden
#nullable disable
                    ));
                    __builder3.AddAttribute(128, "AllowSorting", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Boolean>(
#nullable restore
#line 104 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                                            true

#line default
#line hidden
#nullable disable
                    ));
                    __builder3.AddAttribute(129, "AllowPaging", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Boolean>(
#nullable restore
#line 104 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                                                               true

#line default
#line hidden
#nullable disable
                    ));
                    __builder3.AddAttribute(130, "PageSize", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Int32>(
#nullable restore
#line 105 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                  excelRowGrid.PageSize

#line default
#line hidden
#nullable disable
                    ));
                    __builder3.AddAttribute(131, "Data", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Collections.Generic.IEnumerable<TCProcessExcelRowDTO>>(
#nullable restore
#line 105 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                                                                               processExcelRowDatas.OrderBy(o=>o.per_sheet_name)

#line default
#line hidden
#nullable disable
                    ));
                    __builder3.AddAttribute(132, "ColumnWidth", "120px");
                    __builder3.AddAttribute(133, "FilterCaseSensitivity", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<Radzen.FilterCaseSensitivity>(
#nullable restore
#line 105 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                                                                                                                                                                                                          FilterCaseSensitivity.CaseInsensitive

#line default
#line hidden
#nullable disable
                    ));
                    __builder3.AddAttribute(134, "AllowColumnResize", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Boolean>(
#nullable restore
#line 105 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                                                                                                                                                                                                                                                                    true

#line default
#line hidden
#nullable disable
                    ));
                    __builder3.AddAttribute(135, "Columns", (Microsoft.AspNetCore.Components.RenderFragment)((__builder4) => {
                        __builder4.OpenComponent<Radzen.Blazor.RadzenGridColumn<TCProcessExcelRowDTO>>(136);
                        __builder4.AddAttribute(137, "Property", "per_sheet_name");
                        __builder4.AddAttribute(138, "Title", "Sheet Name");
                        __builder4.CloseComponent();
                        __builder4.AddMarkupContent(139, "\r\n                                    ");
                        __builder4.OpenComponent<Radzen.Blazor.RadzenGridColumn<TCProcessExcelRowDTO>>(140);
                        __builder4.AddAttribute(141, "Property", "per_row_num");
                        __builder4.AddAttribute(142, "Title", "Row No.");
                        __builder4.CloseComponent();
                        __builder4.AddMarkupContent(143, "\r\n                                    ");
                        __builder4.OpenComponent<Radzen.Blazor.RadzenGridColumn<TCProcessExcelRowDTO>>(144);
                        __builder4.AddAttribute(145, "Property", "per_macro_name");
                        __builder4.AddAttribute(146, "Title", "Macro Name");
                        __builder4.CloseComponent();
                        __builder4.AddMarkupContent(147, "\r\n                                    ");
                        __builder4.OpenComponent<Radzen.Blazor.RadzenGridColumn<TCProcessExcelRowDTO>>(148);
                        __builder4.AddAttribute(149, "Property", "per_row_group_num");
                        __builder4.AddAttribute(150, "Title", "Row Group No.");
                        __builder4.CloseComponent();
                        __builder4.AddMarkupContent(151, "\r\n                                    ");
                        __builder4.OpenComponent<Radzen.Blazor.RadzenGridColumn<TCProcessExcelRowDTO>>(152);
                        __builder4.AddAttribute(153, "Property", "per_row_group_name");
                        __builder4.AddAttribute(154, "Title", "Row Group Name");
                        __builder4.CloseComponent();
                        __builder4.AddMarkupContent(155, "\r\n                                    ");
                        __builder4.OpenComponent<Radzen.Blazor.RadzenGridColumn<TCProcessExcelRowDTO>>(156);
                        __builder4.AddAttribute(157, "Property", "per_row_name");
                        __builder4.AddAttribute(158, "Title", "Row Name");
                        __builder4.CloseComponent();
                    }
                    ));
                    __builder3.AddComponentReferenceCapture(159, (__value) => {
#nullable restore
#line 105 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                                               excelRowGrid.radzenGrid = (Radzen.Blazor.RadzenGrid<TCProcessExcelRowDTO>)__value;

#line default
#line hidden
#nullable disable
                    }
                    );
                    __builder3.CloseComponent();
                    __builder3.AddMarkupContent(160, "\r\n                            <br>");
                    __builder3.CloseElement();
                }
                ));
                __builder2.CloseComponent();
                __builder2.AddMarkupContent(161, "\r\n                    ");
                __builder2.OpenComponent<Radzen.Blazor.RadzenTabsItem>(162);
                __builder2.AddAttribute(163, "Text", "Initial");
                __builder2.AddAttribute(164, "Selected", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Boolean>(
#nullable restore
#line 119 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                               _CurrentTab == "INITIAL" ? true : false

#line default
#line hidden
#nullable disable
                ));
                __builder2.AddAttribute(165, "ChildContent", (Microsoft.AspNetCore.Components.RenderFragment)((__builder3) => {
                    __builder3.OpenElement(166, "div");
                    __builder3.AddAttribute(167, "class", "row");
                    __builder3.OpenComponent<Radzen.Blazor.RadzenGrid<TCProcessExcelTemplateDTO>>(168);
                    __builder3.AddAttribute(169, "AllowFiltering", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Boolean>(
#nullable restore
#line 121 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                        true

#line default
#line hidden
#nullable disable
                    ));
                    __builder3.AddAttribute(170, "AllowSorting", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Boolean>(
#nullable restore
#line 121 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                                            true

#line default
#line hidden
#nullable disable
                    ));
                    __builder3.AddAttribute(171, "AllowPaging", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Boolean>(
#nullable restore
#line 121 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                                                               true

#line default
#line hidden
#nullable disable
                    ));
                    __builder3.AddAttribute(172, "PageSize", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Int32>(
#nullable restore
#line 122 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                  excelTemplateGrid.PageSize

#line default
#line hidden
#nullable disable
                    ));
                    __builder3.AddAttribute(173, "Data", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Collections.Generic.IEnumerable<TCProcessExcelTemplateDTO>>(
#nullable restore
#line 122 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                                                                                         processExcelTemplateDatas.OrderBy(o=>o.pet_sheet_name)

#line default
#line hidden
#nullable disable
                    ));
                    __builder3.AddAttribute(174, "ColumnWidth", "120px");
                    __builder3.AddAttribute(175, "FilterCaseSensitivity", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<Radzen.FilterCaseSensitivity>(
#nullable restore
#line 122 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                                                                                                                                                                                                                              FilterCaseSensitivity.CaseInsensitive

#line default
#line hidden
#nullable disable
                    ));
                    __builder3.AddAttribute(176, "AllowColumnResize", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Boolean>(
#nullable restore
#line 122 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                                                                                                                                                                                                                                                                                        true

#line default
#line hidden
#nullable disable
                    ));
                    __builder3.AddAttribute(177, "Columns", (Microsoft.AspNetCore.Components.RenderFragment)((__builder4) => {
                        __builder4.OpenComponent<Radzen.Blazor.RadzenGridColumn<TCProcessExcelTemplateDTO>>(178);
                        __builder4.AddAttribute(179, "Property", "pet_sheet_name");
                        __builder4.AddAttribute(180, "Title", "Sheet Name");
                        __builder4.CloseComponent();
                        __builder4.AddMarkupContent(181, "\r\n                                    ");
                        __builder4.OpenComponent<Radzen.Blazor.RadzenGridColumn<TCProcessExcelTemplateDTO>>(182);
                        __builder4.AddAttribute(183, "Property", "pet_row_num");
                        __builder4.AddAttribute(184, "Title", "Row No.");
                        __builder4.CloseComponent();
                        __builder4.AddMarkupContent(185, "\r\n                                    ");
                        __builder4.OpenComponent<Radzen.Blazor.RadzenGridColumn<TCProcessExcelTemplateDTO>>(186);
                        __builder4.AddAttribute(187, "Property", "pet_col_num");
                        __builder4.AddAttribute(188, "Title", "Column No.");
                        __builder4.CloseComponent();
                        __builder4.AddMarkupContent(189, "\r\n                                    ");
                        __builder4.OpenComponent<Radzen.Blazor.RadzenGridColumn<TCProcessExcelTemplateDTO>>(190);
                        __builder4.AddAttribute(191, "Property", "pet_cell_sup");
                        __builder4.AddAttribute(192, "Title", "Superscript");
                        __builder4.CloseComponent();
                    }
                    ));
                    __builder3.AddComponentReferenceCapture(193, (__value) => {
#nullable restore
#line 122 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                                                    excelTemplateGrid.radzenGrid = (Radzen.Blazor.RadzenGrid<TCProcessExcelTemplateDTO>)__value;

#line default
#line hidden
#nullable disable
                    }
                    );
                    __builder3.CloseComponent();
                    __builder3.AddMarkupContent(194, "\r\n                            <br>");
                    __builder3.CloseElement();
                }
                ));
                __builder2.CloseComponent();
            }
            ));
            __builder.CloseComponent();
            __builder.CloseElement();
#nullable restore
#line 144 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
         if (showPopupDialogUpload)
        {

#line default
#line hidden
#nullable disable
            __builder.OpenElement(195, "div");
            __builder.AddAttribute(196, "class", "modal");
            __builder.AddAttribute(197, "tabindex", "-1");
            __builder.AddAttribute(198, "style", "display:block");
            __builder.AddAttribute(199, "role", "dialog");
            __builder.OpenElement(200, "div");
            __builder.AddAttribute(201, "class", "modal-dialog");
            __builder.OpenElement(202, "div");
            __builder.AddAttribute(203, "class", "modal-content");
            __builder.AddMarkupContent(204, "<div class=\"modal-header\"></div>\r\n                        ");
            __builder.OpenElement(205, "div");
            __builder.AddAttribute(206, "class", "modal-body");
            __builder.OpenElement(207, "div");
            __builder.AddAttribute(208, "class", "row justify-content-center");
            __builder.OpenElement(209, "div");
            __builder.AddAttribute(210, "class", "col-12");
            __builder.OpenElement(211, "div");
            __builder.AddAttribute(212, "class", "row justify-content-center divGroup");
            __builder.OpenElement(213, "div");
            __builder.AddAttribute(214, "class", "col");
            __builder.OpenComponent<ALISS.Shared.LabelBox>(215);
            __builder.AddAttribute(216, "inputLabel", "Upload File");
            __builder.CloseComponent();
            __builder.CloseElement();
            __builder.AddMarkupContent(217, "\r\n                                        ");
            __builder.OpenElement(218, "div");
            __builder.AddAttribute(219, "class", "col");
            __builder.OpenComponent<Microsoft.AspNetCore.Components.Forms.InputFile>(220);
            __builder.AddAttribute(221, "OnChange", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<Microsoft.AspNetCore.Components.EventCallback<Microsoft.AspNetCore.Components.Forms.InputFileChangeEventArgs>>(Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Forms.InputFileChangeEventArgs>(this, 
#nullable restore
#line 162 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                                 OnInputFileChange

#line default
#line hidden
#nullable disable
            )));
            __builder.CloseComponent();
            __builder.CloseElement();
            __builder.CloseElement();
            __builder.CloseElement();
            __builder.AddMarkupContent(222, "\r\n\r\n                                ");
            __builder.AddMarkupContent(223, "<div class=\"col-12\"><div class=\"row justify-content-center divGroup\"><div class=\"col\"></div>\r\n                                        <div class=\"col\" style=\"font-size:small\"><label>(ไฟล์ต้องมีขนาดไม่เกิน 500MB)</label></div></div></div>");
#nullable restore
#line 178 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                 if (selectedFiles != null)
                                {

#line default
#line hidden
#nullable disable
            __builder.OpenElement(224, "div");
            __builder.AddAttribute(225, "class", "col-12");
            __builder.OpenElement(226, "div");
            __builder.AddAttribute(227, "class", "row justify-content-center divGroup");
            __builder.OpenElement(228, "div");
            __builder.AddAttribute(229, "class", "col");
            __builder.OpenComponent<ALISS.Shared.LabelBox>(230);
            __builder.AddAttribute(231, "inputLabel", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.String>(
#nullable restore
#line 183 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                                       configData.Get_Label("Filename")

#line default
#line hidden
#nullable disable
            ));
            __builder.CloseComponent();
            __builder.CloseElement();
            __builder.AddMarkupContent(232, "\r\n                                            ");
            __builder.OpenElement(233, "div");
            __builder.AddAttribute(234, "class", "col");
            __builder.OpenElement(235, "label");
            __builder.AddContent(236, 
#nullable restore
#line 186 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                        selectedFiles.Name

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.CloseElement();
            __builder.CloseElement();
            __builder.CloseElement();
            __builder.AddMarkupContent(237, "\r\n                                    ");
            __builder.OpenElement(238, "div");
            __builder.AddAttribute(239, "class", "col-12");
            __builder.OpenElement(240, "div");
            __builder.AddAttribute(241, "class", "row justify-content-center divGroup");
            __builder.OpenElement(242, "div");
            __builder.AddAttribute(243, "class", "col");
            __builder.OpenElement(244, "div");
            __builder.AddContent(245, 
#nullable restore
#line 193 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                      LargeUploadMessage

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.AddMarkupContent(246, "\r\n                                                ");
            __builder.OpenElement(247, "progress");
            __builder.AddAttribute(248, "style", "height:50px;width:100%;");
            __builder.AddAttribute(249, "value", 
#nullable restore
#line 194 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                                                                  UploadedBytes

#line default
#line hidden
#nullable disable
            );
            __builder.AddAttribute(250, "max", 
#nullable restore
#line 194 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                                                                                       TotalBytes

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.CloseElement();
            __builder.CloseElement();
            __builder.CloseElement();
#nullable restore
#line 198 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"

                                }

#line default
#line hidden
#nullable disable
            __builder.OpenElement(251, "div");
            __builder.AddAttribute(252, "class", "col-xl-12");
            __builder.OpenElement(253, "div");
            __builder.AddAttribute(254, "class", "row justify-content-center divGroup buttonArea");
            __builder.OpenElement(255, "div");
            __builder.AddAttribute(256, "class", "col-auto");
            __builder.OpenComponent<Radzen.Blazor.RadzenButton>(257);
            __builder.AddAttribute(258, "class", "btnCancel");
            __builder.AddAttribute(259, "Text", "Cancel");
            __builder.AddAttribute(260, "Click", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<Microsoft.AspNetCore.Components.EventCallback<Microsoft.AspNetCore.Components.Web.MouseEventArgs>>(Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 203 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                                                                 ClosePopupDialogUpload

#line default
#line hidden
#nullable disable
            )));
            __builder.CloseComponent();
            __builder.CloseElement();
            __builder.AddMarkupContent(261, "\r\n                                        ");
            __builder.OpenElement(262, "div");
            __builder.AddAttribute(263, "class", "col-auto");
            __builder.OpenComponent<Radzen.Blazor.RadzenButton>(264);
            __builder.AddAttribute(265, "Icon", "save");
            __builder.AddAttribute(266, "ButtonType", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<Radzen.ButtonType>(
#nullable restore
#line 206 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                                                  ButtonType.Submit

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(267, "class", "btnSave");
            __builder.AddAttribute(268, "Text", "Upload");
            __builder.AddAttribute(269, "Click", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<Microsoft.AspNetCore.Components.EventCallback<Microsoft.AspNetCore.Components.Web.MouseEventArgs>>(Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 206 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                                                                                                            () => UploadData()

#line default
#line hidden
#nullable disable
            )));
            __builder.AddAttribute(270, "disabled", 
#nullable restore
#line 207 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                                                                      ((selectedFiles == null)  || (Uploading)) ? true : false

#line default
#line hidden
#nullable disable
            );
            __builder.CloseComponent();
            __builder.CloseElement();
            __builder.CloseElement();
            __builder.CloseElement();
            __builder.CloseElement();
            __builder.CloseElement();
            __builder.CloseElement();
            __builder.CloseElement();
            __builder.CloseElement();
#nullable restore
#line 216 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
        }

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
            __builder.AddMarkupContent(271, "<hr>");
            __builder.OpenComponent<ALISS.Shared.Loading>(272);
            __builder.AddAttribute(273, "ShowModel", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Boolean>(
#nullable restore
#line 221 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
                        showLoading

#line default
#line hidden
#nullable disable
            ));
            __builder.CloseComponent();
#nullable restore
#line 222 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
}

#line default
#line hidden
#nullable disable
        }
        #pragma warning restore 1998
#nullable restore
#line 224 "D:\G-able\GitHub\ALISS_PROJECT\ALISS\Pages\P4_UserManagement\MasterManagement\MasterTemplateUpload.razor"
       
    [CascadingParameter] MainLayout mainLayout { get; set; }
    [Parameter] public string mst_code { get; set; }

    private ConfigData configData = new ConfigData();
    private string classLabel = "col-4";
    private string classInput = "col-8";
    private bool showLoading;
    private string _CurrentTab = "TEMPLATECOLUMNS";
    private bool showModal = false;

    private IBrowserFile selectedFiles;

    string LargeUploadMessage = "";
    long UploadedBytes;
    long TotalBytes;
    bool Uploading = false;

    private MasterTemplateDTO masterTemplateData = new MasterTemplateDTO();
    private List<TCProcessExcelColumnDTO> processExcelColumnDatas;
    private List<TCProcessExcelRowDTO> processExcelRowDatas;
    private List<TCProcessExcelTemplateDTO> processExcelTemplateDatas;

    RadzenGridCustom<TCProcessExcelColumnDTO> excelColumnGrid = new RadzenGridCustom<TCProcessExcelColumnDTO>();
    RadzenGridCustom<TCProcessExcelRowDTO> excelRowGrid = new RadzenGridCustom<TCProcessExcelRowDTO>();
    RadzenGridCustom<TCProcessExcelTemplateDTO> excelTemplateGrid = new RadzenGridCustom<TCProcessExcelTemplateDTO>();

    private bool showPopupDialogUpload = false;

    private bool pageLoading { get { return (processExcelColumnDatas == null || processExcelRowDatas == null || processExcelTemplateDatas == null); } }

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            await mainLayout.GetLoginUser();

            if (mainLayout.loginUser.CheckPagePermission("MNU_0202") == false) navigationManager.NavigateTo("/NoPermissionPage");

            configData.ConfigDTOList = await configDataService.Get_TBConfig_DataList_Async(new TBConfigDTO() { tbc_mnu_code = "MNU_0202" });
            if (mainLayout.loginUser.rol_code == "ROL_00")
            {
                configData.ConfigDTOList.ForEach(x =>
                {
                    x.tbc_edit = true;
                });
            }

            if (!string.IsNullOrEmpty(mst_code))
            {
                masterTemplateData = await masterTemplateService.GetDataAsync(mst_code);

                masterTemplateData.mst_status = "E";
                masterTemplateData.mst_updateuser = mainLayout.loginUser.Username;

                processExcelColumnDatas = await processExcelService.Get_TCProcessExcelColumn_DataList_Async(new TCProcessExcelColumnDTO() { pec_mst_code = mst_code });
                processExcelRowDatas = await processExcelService.Get_TCProcessExcelRow_DataList_Async(new TCProcessExcelRowDTO() { per_mst_code = mst_code });
                processExcelTemplateDatas = await processExcelService.Get_TCProcessExcelTemplate_DataList_Async(new TCProcessExcelTemplateDTO() { pet_mst_code = mst_code });
            }

            StateHasChanged();
        }
    }

    private void HandleInvalidSubmit()
    {

    }

    private async void HandleValidSubmit()
    {

    }

    private async void DownloadData()
    {

        var x = processExcelColumnDatas.FirstOrDefault();
        var str_CurrentDate = x.pec_createdate?.ToString("yyyyMMdd");
        string filepath = await processExcelService.GetPath();

        filepath = Path.Combine(filepath, str_CurrentDate, mst_code);
        var filename = "template antibiogram 2025.xlsm";
        var fullpath = Path.Combine(filepath, filename);

        if (File.Exists(fullpath))
        {
            byte[] bytes = File.ReadAllBytes(fullpath);
            await downloadService.DownloadFile(filename, bytes, "application/vnd.ms-excel.sheet.macroEnabled.12");
        }
        else
        {
            await jsRuntime.InvokeAsync<object>("ShowAlert", "File not Found");
        }
    }

    private async void UploadData()
    {
        string confirmMessage = "";
        bool bReplace = false;
        Uploading = true;

        if ((processExcelColumnDatas.Count() > 0) && (processExcelRowDatas.Count() > 0) && (processExcelTemplateDatas.Count() > 0))
        {
            confirmMessage = "ไฟล์ที่อัพโหลดใหม่ จะแทนที่ข้อมูลไฟล์เดิม ต้องการยืนยันอัพโหลดไฟล์ใหม่ ใช่หรือไม่? " + "\n";
            bReplace = true;
        }
        else
        {
            confirmMessage = "Confirm upload data." + "\n" + " File Name: " + selectedFiles.Name + "\n";
        }

        var result = await jsRuntime.InvokeAsync<bool>("ShowConfirm", confirmMessage);
        if (result == false)
        {
            return;
        }

        showModal = true;

        LargeUploadMessage = "กำลังอัปโหลดไฟล์";
        //string str_CurrentDate = DateTime.Now.ToString("yyyyMMdd");

        string filepath = await masterTemplateService.GetPath();
        //filepath = Path.Combine(filepath, str_CurrentDate, mst_code);
        filepath = Path.Combine(filepath, "MasterTemplate", masterTemplateData.mst_code, "ExcelTemplate");


        bool exists = System.IO.Directory.Exists(filepath);

        if (!exists)
            System.IO.Directory.CreateDirectory(filepath);

        var filename = Path.Combine(filepath, selectedFiles.Name);

        UploadedBytes = 0;

        TotalBytes = selectedFiles.Size;

        long percent = 0;
        long chunckSize = 400000;
        long numChunks = TotalBytes / chunckSize;
        long remainder = TotalBytes % chunckSize;

        if (File.Exists(filename)) File.Delete(filename);

        using (var inStream = selectedFiles.OpenReadStream(long.MaxValue))
        {
            using (var outStream = File.OpenWrite(filename))
            {
                for (int i = 0; i < numChunks; i++)
                {
                    var buffer = new byte[chunckSize];
                    await inStream.ReadAsync(buffer, 0, buffer.Length);

                    await outStream.WriteAsync(buffer, 0, buffer.Length);

                    UploadedBytes += chunckSize;

                    percent = UploadedBytes * 100 / TotalBytes;

                    LargeUploadMessage = $"กำลังอัปโหลดไฟล์ {percent}%";

                    await InvokeAsync(StateHasChanged);
                }

                if (remainder > 0)
                {
                    var buffer = new byte[remainder];
                    await inStream.ReadAsync(buffer, 0, buffer.Length);

                    await outStream.WriteAsync(buffer, 0, buffer.Length);

                    UploadedBytes += remainder;

                    percent = UploadedBytes * 100 / TotalBytes;

                    LargeUploadMessage = $"กำลังอัปโหลดไฟล์ {percent}%";

                    await InvokeAsync(StateHasChanged);
                }
            }
        }

        LargeUploadMessage = "กำลังตรวจสอบไฟล์ ...";
        await InvokeAsync(StateHasChanged);

        var chkValidate = await processExcelService.ValidateProcessExcelFileAsync(filename, masterTemplateData, mst_code, mainLayout.loginUser.Username, bReplace);


        await InvokeAsync(StateHasChanged);

        if (chkValidate != null)
        {
            string ErrorMessage = "";
            foreach (TCProcessExcelErrorDTO item in chkValidate)
            {
                if (item.tcp_status == 'E')
                    ErrorMessage += "- " + item.tcp_Err_Message + "\n";
            }
            if (!string.IsNullOrEmpty(ErrorMessage))
            {
                await jsRuntime.InvokeAsync<object>("ShowAlert", ErrorMessage);
                LargeUploadMessage = "พบข้อผิดพลาด";
            }

            else
            {
                LargeUploadMessage = "อัปโหลดเรียบร้อยแล้ว";
                await ClosePopupDialogUpload();
                await jsRuntime.InvokeAsync<object>("ShowAlert", "Upload completed.");
            }

        }
        else
        {
            LargeUploadMessage = "อัปโหลดเรียบร้อยแล้ว";
            await ClosePopupDialogUpload();
            await jsRuntime.InvokeAsync<object>("ShowAlert", "Upload completed.");
        }

        var chkError = chkValidate.FirstOrDefault(x => x.tcp_status == 'E');
    

        UploadedBytes = 0;
        TotalBytes = 0;
        LargeUploadMessage = "";
        Uploading = false;
    }

    private async Task ClosePopupDialogUpload()
    {
        showPopupDialogUpload = false;

        processExcelColumnDatas = await processExcelService.Get_TCProcessExcelColumn_DataList_Async(new TCProcessExcelColumnDTO() { pec_mst_code = mst_code });
        processExcelRowDatas = await processExcelService.Get_TCProcessExcelRow_DataList_Async(new TCProcessExcelRowDTO() { per_mst_code = mst_code });
        processExcelTemplateDatas = await processExcelService.Get_TCProcessExcelTemplate_DataList_Async(new TCProcessExcelTemplateDTO() { pet_mst_code = mst_code });

        showLoading = false;
        StateHasChanged();
    }

    private async Task OnInputFileChange(InputFileChangeEventArgs e)
    {
        selectedFiles = e.File;

        var type = Path.GetExtension(selectedFiles.Name);

        long maxFileSize = 1024L; // 1KB
        maxFileSize *= 1024L; // 1MB
        maxFileSize *= 512L; // 0.5GB

        if (selectedFiles.Size > maxFileSize)
        {
            await jsRuntime.InvokeAsync<object>("ShowAlert", "ไม่สามารถ Upload ไฟล์ ขนาดมากกว่า 500MB ได้");
            selectedFiles = null;
            return;
        }
    }

    private void ShowPopupDialogUpload()
    {
        showPopupDialogUpload = true;
    }

    private void RedirectToInbox()
    {
        navigationManager.NavigateTo("MasterManagement/MasterTemplate/");
    }

#line default
#line hidden
#nullable disable
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IBlazorDownloadFileService downloadService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private ProcessExcelService processExcelService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private WHONETColumnService whonetColumnService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private ExpertRuleService expertRuleService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private QCRangeService qcrangeService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private OrganismService organismService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private AntibioticService antibioticService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private SpecimenService specimenService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private WardTypeService wardTypeService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private MasterTemplateService masterTemplateService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private ConfigDataService configDataService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private DialogService dialogService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private NavigationManager navigationManager { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IJSRuntime jsRuntime { get; set; }
    }
}
namespace __Blazor.ALISS.Pages.P4_UserManagement.MasterManagement.MasterTemplateUpload
{
    #line hidden
    internal static class TypeInference
    {
        public static void CreateRadzenDatePicker_0<TValue>(global::Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder, int seq, int __seq0, global::System.String __arg0, int __seq1, global::System.Boolean __arg1, int __seq2, global::System.String __arg2, int __seq3, global::System.Object __arg3, int __seq4, global::Microsoft.AspNetCore.Components.EventCallback<TValue> __arg4, int __seq5, global::System.Linq.Expressions.Expression<global::System.Func<TValue>> __arg5)
        {
        __builder.OpenComponent<global::Radzen.Blazor.RadzenDatePicker<TValue>>(seq);
        __builder.AddAttribute(__seq0, "DateFormat", __arg0);
        __builder.AddAttribute(__seq1, "ReadOnly", __arg1);
        __builder.AddAttribute(__seq2, "Style", __arg2);
        __builder.AddAttribute(__seq3, "Value", __arg3);
        __builder.AddAttribute(__seq4, "ValueChanged", __arg4);
        __builder.AddAttribute(__seq5, "ValueExpression", __arg5);
        __builder.CloseComponent();
        }
        public static void CreateValidationMessage_1<TValue>(global::Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder, int seq, int __seq0, global::System.Linq.Expressions.Expression<global::System.Func<TValue>> __arg0)
        {
        __builder.OpenComponent<global::Microsoft.AspNetCore.Components.Forms.ValidationMessage<TValue>>(seq);
        __builder.AddAttribute(__seq0, "For", __arg0);
        __builder.CloseComponent();
        }
    }
}
#pragma warning restore 1591
